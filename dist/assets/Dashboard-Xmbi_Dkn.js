import{u as X,a as K,r as n,j as e,t as u}from"./index-BToGKl4C.js";import{d as Q,e as Y,f as x,h as C,i as Z}from"./db-nqeXl3hD.js";import{B as i,C as a,d as l,a as T,b as M}from"./card-D3FJTV3E.js";import{B as ee}from"./badge-93OQ6PlQ.js";import{T as se,a as te,b as E,c as w}from"./tabs-DHqpCJ_0.js";import{L as ae}from"./log-out-DFYYjqEx.js";import{C as le}from"./clock-izyGzFpI.js";import{c as O}from"./createLucideIcon-DePTzsAY.js";import{D as ce}from"./dollar-sign-CEozzTHh.js";import{F as B}from"./file-text-2p1esPSl.js";import"./mockData-meiYRdoj.js";import"./index-C2-HvyGl.js";import"./index-Bym7oP2B.js";import"./index-CpMpevxU.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],A=O("circle-check-big",re);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],I=O("circle-x",ne);function Ce(){const{user:d,logout:U}=X(),N=K(),[m,g]=n.useState([]),[z,L]=n.useState([]),[V,o]=n.useState([]),[h,_]=n.useState("ALL"),[y,G]=n.useState("ALL"),[D,J]=n.useState("");n.useEffect(()=>{(!d||!["ADMIN","SUPER_ADMIN","DEVELOPER"].includes(d.role))&&N("/login"),Q().then(g),Y().then(s=>{L(s.filter(t=>!["SUPER_ADMIN","DEVELOPER"].includes(t.role)))}),x().then(o)},[d,N]);const $=()=>{U(),N("/login")},p=m.filter(s=>s.paymentStatus==="PENDING"&&s.paymentMethod==="RECEIPT"),j=m.filter(s=>s.paymentStatus==="APPROVED"),v=m.filter(s=>s.paymentStatus==="REJECTED"),F=async s=>{await C(s,{paymentStatus:"APPROVED",status:"CONFIRMED"}),g(t=>t.filter(r=>r.id!==s)),u.success("Payment approved and booking confirmed!"),x().then(o)},R=async s=>{await C(s,{paymentStatus:"REJECTED",status:"CANCELLED"}),g(t=>t.filter(r=>r.id!==s)),u.error("Payment rejected and booking cancelled."),x().then(o)},q=async(s,t)=>{["SUPER_ADMIN","DEVELOPER"].includes(t)||(await Z(s,t),L(r=>r.map(c=>c.id===s?{...c,role:t}:c)),u.success("Role updated"))},H=async s=>{await C(s,{status:"CANCELLED"}),u.success("Booking cancelled"),x().then(o)},P=V.filter(s=>{var S,b,k;const t=h==="ALL"?!0:s.status===h||s.paymentStatus===h,r=y==="ALL"?!0:s.paymentMethod===y,c=D.trim().toLowerCase(),W=!c||((S=s.studentName)==null?void 0:S.toLowerCase().includes(c))||((b=s.lecturerName)==null?void 0:b.toLowerCase().includes(c))||((k=s.subject)==null?void 0:k.toLowerCase().includes(c));return t&&r&&W}),f=({booking:s})=>e.jsx(a,{children:e.jsx(l,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:s.studentName}),e.jsxs("p",{className:"text-sm",style:{color:"#0066FF"},children:[s.lecturerName," - ",s.subject]})]}),e.jsx(ee,{style:{backgroundColor:"#FFD700",color:"#000"},children:s.paymentStatus})]}),e.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Date:"})," ",new Date(s.date).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Time:"})," ",s.time]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Amount:"})," $",s.price]})]}),s.receiptUrl&&e.jsxs("div",{className:"p-3 rounded-lg",style:{backgroundColor:"#f9fafb"},children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(B,{className:"w-4 h-4",style:{color:"#0066FF"}}),e.jsx("span",{className:"text-gray-600",children:"Receipt uploaded"})]}),e.jsx("a",{href:s.receiptUrl,target:"_blank",rel:"noopener noreferrer",className:"text-xs mt-1 block",style:{color:"#0066FF"},children:"View receipt →"})]}),s.paymentStatus==="PENDING"&&e.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-2",children:[e.jsxs(i,{size:"sm",className:"text-white",style:{backgroundColor:"#10b981"},onClick:()=>F(s.id),children:[e.jsx(A,{className:"w-4 h-4 mr-1"}),"Approve"]}),e.jsxs(i,{size:"sm",variant:"outline",style:{borderColor:"#ef4444",color:"#ef4444"},onClick:()=>R(s.id),children:[e.jsx(I,{className:"w-4 h-4 mr-1"}),"Reject"]})]})]})})});return e.jsxs("div",{className:"min-h-screen",style:{backgroundColor:"#f8f9fa"},children:[e.jsx("div",{className:"sticky top-0 z-10 shadow-sm",style:{backgroundColor:"#0066FF"},children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:"/logo.png",alt:"smartlabs",className:"w-10 h-10 rounded-full bg-white object-cover"}),e.jsx("p",{className:"text-white/80 text-xs",children:"Admin Portal"})]}),e.jsx(i,{variant:"ghost",size:"sm",onClick:$,className:"text-white hover:bg-white/20",children:e.jsx(ae,{className:"w-4 h-4"})})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("h2",{className:"text-2xl font-bold mb-1",style:{color:"#0066FF"},children:["Welcome, ",d==null?void 0:d.name,"!"]}),e.jsx("p",{className:"text-gray-600",children:"Manage payments and bookings"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-6",children:[e.jsx(a,{children:e.jsxs(l,{className:"p-4 text-center",children:[e.jsx(le,{className:"w-6 h-6 mx-auto mb-2",style:{color:"#FFD700"}}),e.jsx("p",{className:"text-2xl font-bold",children:p.length}),e.jsx("p",{className:"text-xs text-gray-600",children:"Pending"})]})}),e.jsx(a,{children:e.jsxs(l,{className:"p-4 text-center",children:[e.jsx(A,{className:"w-6 h-6 mx-auto mb-2",style:{color:"#10b981"}}),e.jsx("p",{className:"text-2xl font-bold",children:j.length}),e.jsx("p",{className:"text-xs text-gray-600",children:"Approved"})]})}),e.jsx(a,{children:e.jsxs(l,{className:"p-4 text-center",children:[e.jsx(ce,{className:"w-6 h-6 mx-auto mb-2",style:{color:"#0066FF"}}),e.jsx("p",{className:"text-2xl font-bold",children:m.length}),e.jsx("p",{className:"text-xs text-gray-600",children:"Total"})]})})]}),e.jsxs(se,{defaultValue:"pending",className:"w-full",children:[e.jsxs(te,{className:"grid w-full grid-cols-3 mb-6",children:[e.jsxs(E,{value:"pending",children:["Pending (",p.length,")"]}),e.jsxs(E,{value:"approved",children:["Approved (",j.length,")"]}),e.jsxs(E,{value:"rejected",children:["Rejected (",v.length,")"]})]}),e.jsx(w,{value:"pending",className:"space-y-4",children:p.length>0?p.map(s=>e.jsx(f,{booking:s},s.id)):e.jsx(a,{children:e.jsxs(l,{className:"p-8 text-center",children:[e.jsx(B,{className:"w-12 h-12 mx-auto mb-3 text-gray-400"}),e.jsx("p",{className:"text-gray-600",children:"No pending payment approvals"})]})})}),e.jsx(w,{value:"approved",className:"space-y-4",children:j.length>0?j.map(s=>e.jsx(f,{booking:s},s.id)):e.jsx(a,{children:e.jsxs(l,{className:"p-8 text-center",children:[e.jsx(A,{className:"w-12 h-12 mx-auto mb-3 text-gray-400"}),e.jsx("p",{className:"text-gray-600",children:"No approved payments"})]})})}),e.jsx(w,{value:"rejected",className:"space-y-4",children:v.length>0?v.map(s=>e.jsx(f,{booking:s},s.id)):e.jsx(a,{children:e.jsxs(l,{className:"p-8 text-center",children:[e.jsx(I,{className:"w-12 h-12 mx-auto mb-3 text-gray-400"}),e.jsx("p",{className:"text-gray-600",children:"No rejected payments"})]})})})]}),e.jsxs(a,{className:"mt-6",children:[e.jsx(T,{children:e.jsx(M,{style:{color:"#0066FF"},children:"All Bookings"})}),e.jsxs(l,{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-3",children:[e.jsx("input",{className:"border rounded px-2 py-1 text-sm",placeholder:"Search student, lecturer, subject",value:D,onChange:s=>J(s.target.value)}),e.jsxs("select",{className:"border rounded px-2 py-1 text-sm",value:h,onChange:s=>_(s.target.value),children:[e.jsx("option",{value:"ALL",children:"All statuses"}),e.jsx("option",{value:"CONFIRMED",children:"Confirmed"}),e.jsx("option",{value:"PENDING",children:"Pending"}),e.jsx("option",{value:"APPROVED",children:"Approved"}),e.jsx("option",{value:"REJECTED",children:"Rejected"}),e.jsx("option",{value:"CANCELLED",children:"Cancelled"})]}),e.jsxs("select",{className:"border rounded px-2 py-1 text-sm",value:y,onChange:s=>G(s.target.value),children:[e.jsx("option",{value:"ALL",children:"All methods"}),e.jsx("option",{value:"VISA",children:"Visa"}),e.jsx("option",{value:"RECEIPT",children:"Receipt"})]}),e.jsx(i,{variant:"outline",onClick:()=>x().then(o),children:"Refresh"})]}),e.jsxs("div",{className:"space-y-3",children:[P.map(s=>e.jsx("div",{className:"p-3 rounded-lg border",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-sm",children:s.studentName}),e.jsxs("p",{className:"text-xs",style:{color:"#0066FF"},children:[s.lecturerName," • ",s.subject]}),e.jsxs("p",{className:"text-xs text-gray-600",children:[new Date(s.date).toLocaleDateString()," at ",s.time," • $",s.price]})]}),e.jsxs("div",{className:"flex gap-2",children:[s.paymentMethod==="RECEIPT"&&s.paymentStatus==="PENDING"&&e.jsxs(e.Fragment,{children:[e.jsx(i,{size:"sm",onClick:()=>F(s.id),children:"Approve"}),e.jsx(i,{size:"sm",variant:"outline",onClick:()=>R(s.id),children:"Reject"})]}),s.status!=="CANCELLED"&&e.jsx(i,{size:"sm",variant:"outline",onClick:()=>H(s.id),children:"Cancel"})]})]})},s.id)),P.length===0&&e.jsx("div",{className:"text-sm text-gray-600",children:"No bookings found"})]})]})]}),e.jsxs(a,{className:"mt-6",children:[e.jsx(T,{children:e.jsx(M,{style:{color:"#0066FF"},children:"User Management"})}),e.jsx(l,{children:e.jsx("div",{className:"space-y-3",children:z.map(s=>e.jsxs("div",{className:"p-3 rounded-lg border flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-sm",children:s.name}),e.jsx("p",{className:"text-xs text-gray-600",children:s.email})]}),e.jsxs("select",{className:"border rounded px-2 py-1 text-xs",value:s.role,onChange:t=>q(s.id,t.target.value),children:[e.jsx("option",{value:"STUDENT",children:"Student"}),e.jsx("option",{value:"LECTURER",children:"Lecturer"}),e.jsx("option",{value:"ADMIN",children:"Admin"})]})]},s.id))})})]})]})]})}export{Ce as default};
