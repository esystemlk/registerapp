import{u as h,a as j,r,j as s,B as c}from"./index-29trkLDX.js";import{w as n,x as o}from"./db-DRhg_JvH.js";import{H as f}from"./HeaderBar-qIyb8_N6.js";import{C as N,a as E,b as v,d as S}from"./card-WBB6GQn7.js";function D(){const{user:t}=h(),d=j(),[x,a]=r.useState([]),[i,u]=r.useState("ALL");r.useEffect(()=>{if(!t||!["ADMIN","SUPER_ADMIN","DEVELOPER"].includes(t.role)){d("/login");return}n().then(a)},[t]);const l=x.filter(e=>i==="ALL"?!0:e.status===i),m=async e=>{await o(e,{status:"ASSIGNED",assignedTo:t.id}),a(await n())},p=async e=>{await o(e,{status:"RESOLVED"}),a(await n())};return s.jsxs("div",{className:"min-h-screen",style:{backgroundColor:"#f8f9fa"},children:[s.jsx(f,{title:"Admin • Support Inbox",color:"#0066FF"}),s.jsxs("div",{className:"max-w-5xl mx-auto px-4 py-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h1",{className:"text-xl font-semibold",style:{color:"#0066FF"},children:"Tickets"}),s.jsxs("select",{className:"border rounded px-2 py-1 text-sm",value:i,onChange:e=>u(e.target.value),children:[s.jsx("option",{value:"ALL",children:"All"}),s.jsx("option",{value:"OPEN",children:"Open"}),s.jsx("option",{value:"ASSIGNED",children:"Assigned"}),s.jsx("option",{value:"RESOLVED",children:"Resolved"})]})]}),s.jsxs("div",{className:"space-y-3",children:[l.map(e=>s.jsxs(N,{children:[s.jsx(E,{children:s.jsxs(v,{className:"flex items-center justify-between",children:[s.jsx("span",{children:e.subject}),s.jsx("span",{className:"text-xs px-2 py-1 rounded",style:{backgroundColor:e.status==="RESOLVED"?"#10b981":e.status==="ASSIGNED"?"#FFD700":"#e5e7eb"},children:e.status})]})}),s.jsxs(S,{className:"space-y-2",children:[s.jsx("p",{className:"text-sm",children:e.message}),s.jsxs("p",{className:"text-xs text-gray-500",children:["From: ",e.userId," • ",new Date(e.createdAt).toLocaleString()]}),s.jsxs("div",{className:"flex gap-2",children:[e.status==="OPEN"&&s.jsx(c,{size:"sm",onClick:()=>m(e.id),children:"Assign to me"}),e.status!=="RESOLVED"&&s.jsx(c,{size:"sm",variant:"outline",onClick:()=>p(e.id),children:"Mark Resolved"})]})]})]},e.id)),l.length===0&&s.jsx("div",{className:"text-sm text-gray-600",children:"No tickets for this filter."})]})]})]})}export{D as default};
