import{r as i,j as e,d as _,S as he,e as b,b as ve,u as je,a as Ne,c as ye,f as Ce,B as y,t as C,h as W,i as De}from"./index-B4Ad_25t.js";import{C as F,d as S,a as G,b as z}from"./card-CoGWnkv-.js";import{L as v}from"./label-CKOw0SqW.js";import{R as be,a as U}from"./radio-group-CEsQC9ue.js";import{I as R}from"./input-Bp-9N0Nk.js";import{u as Pe,c as D,a as Re,b as Ie}from"./index-i2ZupbD7.js";import{u as E,P as k}from"./index-9O4Fc58M.js";import{P as we,h as Fe,R as Se,u as Ee,F as _e,D as ke}from"./index-B-eIdhW6.js";import{P}from"./index-oQduYenF.js";import{c as H}from"./createLucideIcon-BGnTon0B.js";import{A as Ae}from"./arrow-left-DkjRGO3g.js";import{C as Oe}from"./calendar-BK-64CZt.js";import{C as Me}from"./credit-card-E6UXsCxd.js";import{C as Te}from"./check-7XvYrTOL.js";import"./index-DiL10ndF.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],$e=H("upload",Le);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Ve=H("x",Be);var A="Dialog",[Y]=Re(A),[We,m]=Y(A),q=t=>{const{__scopeDialog:a,children:o,open:n,defaultOpen:r,onOpenChange:s,modal:c=!0}=t,d=i.useRef(null),g=i.useRef(null),[f=!1,p]=Pe({prop:n,defaultProp:r,onChange:s});return e.jsx(We,{scope:a,triggerRef:d,contentRef:g,contentId:E(),titleId:E(),descriptionId:E(),open:f,onOpenChange:p,onOpenToggle:i.useCallback(()=>p(N=>!N),[p]),modal:c,children:o})};q.displayName=A;var K="DialogTrigger",Ge=i.forwardRef((t,a)=>{const{__scopeDialog:o,...n}=t,r=m(K,o),s=_(a,r.triggerRef);return e.jsx(P.button,{type:"button","aria-haspopup":"dialog","aria-expanded":r.open,"aria-controls":r.contentId,"data-state":T(r.open),...n,ref:s,onClick:D(t.onClick,r.onOpenToggle)})});Ge.displayName=K;var O="DialogPortal",[ze,X]=Y(O,{forceMount:void 0}),Z=t=>{const{__scopeDialog:a,forceMount:o,children:n,container:r}=t,s=m(O,a);return e.jsx(ze,{scope:a,forceMount:o,children:i.Children.map(n,c=>e.jsx(k,{present:o||s.open,children:e.jsx(we,{asChild:!0,container:r,children:c})}))})};Z.displayName=O;var I="DialogOverlay",J=i.forwardRef((t,a)=>{const o=X(I,t.__scopeDialog),{forceMount:n=o.forceMount,...r}=t,s=m(I,t.__scopeDialog);return s.modal?e.jsx(k,{present:n||s.open,children:e.jsx(Ue,{...r,ref:a})}):null});J.displayName=I;var Ue=i.forwardRef((t,a)=>{const{__scopeDialog:o,...n}=t,r=m(I,o);return e.jsx(Se,{as:he,allowPinchZoom:!0,shards:[r.contentRef],children:e.jsx(P.div,{"data-state":T(r.open),...n,ref:a,style:{pointerEvents:"auto",...n.style}})})}),j="DialogContent",Q=i.forwardRef((t,a)=>{const o=X(j,t.__scopeDialog),{forceMount:n=o.forceMount,...r}=t,s=m(j,t.__scopeDialog);return e.jsx(k,{present:n||s.open,children:s.modal?e.jsx(He,{...r,ref:a}):e.jsx(Ye,{...r,ref:a})})});Q.displayName=j;var He=i.forwardRef((t,a)=>{const o=m(j,t.__scopeDialog),n=i.useRef(null),r=_(a,o.contentRef,n);return i.useEffect(()=>{const s=n.current;if(s)return Fe(s)},[]),e.jsx(ee,{...t,ref:r,trapFocus:o.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:D(t.onCloseAutoFocus,s=>{var c;s.preventDefault(),(c=o.triggerRef.current)==null||c.focus()}),onPointerDownOutside:D(t.onPointerDownOutside,s=>{const c=s.detail.originalEvent,d=c.button===0&&c.ctrlKey===!0;(c.button===2||d)&&s.preventDefault()}),onFocusOutside:D(t.onFocusOutside,s=>s.preventDefault())})}),Ye=i.forwardRef((t,a)=>{const o=m(j,t.__scopeDialog),n=i.useRef(!1),r=i.useRef(!1);return e.jsx(ee,{...t,ref:a,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:s=>{var c,d;(c=t.onCloseAutoFocus)==null||c.call(t,s),s.defaultPrevented||(n.current||(d=o.triggerRef.current)==null||d.focus(),s.preventDefault()),n.current=!1,r.current=!1},onInteractOutside:s=>{var g,f;(g=t.onInteractOutside)==null||g.call(t,s),s.defaultPrevented||(n.current=!0,s.detail.originalEvent.type==="pointerdown"&&(r.current=!0));const c=s.target;((f=o.triggerRef.current)==null?void 0:f.contains(c))&&s.preventDefault(),s.detail.originalEvent.type==="focusin"&&r.current&&s.preventDefault()}})}),ee=i.forwardRef((t,a)=>{const{__scopeDialog:o,trapFocus:n,onOpenAutoFocus:r,onCloseAutoFocus:s,...c}=t,d=m(j,o),g=i.useRef(null),f=_(a,g);return Ee(),e.jsxs(e.Fragment,{children:[e.jsx(_e,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:r,onUnmountAutoFocus:s,children:e.jsx(ke,{role:"dialog",id:d.contentId,"aria-describedby":d.descriptionId,"aria-labelledby":d.titleId,"data-state":T(d.open),...c,ref:f,onDismiss:()=>d.onOpenChange(!1)})}),e.jsxs(e.Fragment,{children:[e.jsx(qe,{titleId:d.titleId}),e.jsx(Xe,{contentRef:g,descriptionId:d.descriptionId})]})]})}),M="DialogTitle",te=i.forwardRef((t,a)=>{const{__scopeDialog:o,...n}=t,r=m(M,o);return e.jsx(P.h2,{id:r.titleId,...n,ref:a})});te.displayName=M;var ae="DialogDescription",se=i.forwardRef((t,a)=>{const{__scopeDialog:o,...n}=t,r=m(ae,o);return e.jsx(P.p,{id:r.descriptionId,...n,ref:a})});se.displayName=ae;var oe="DialogClose",ne=i.forwardRef((t,a)=>{const{__scopeDialog:o,...n}=t,r=m(oe,o);return e.jsx(P.button,{type:"button",...n,ref:a,onClick:D(t.onClick,()=>r.onOpenChange(!1))})});ne.displayName=oe;function T(t){return t?"open":"closed"}var re="DialogTitleWarning",[Rt,ie]=Ie(re,{contentName:j,titleName:M,docsSlug:"dialog"}),qe=({titleId:t})=>{const a=ie(re),o=`\`${a.contentName}\` requires a \`${a.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${a.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${a.docsSlug}`;return i.useEffect(()=>{t&&(document.getElementById(t)||console.error(o))},[o,t]),null},Ke="DialogDescriptionWarning",Xe=({contentRef:t,descriptionId:a})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${ie(Ke).contentName}}.`;return i.useEffect(()=>{var s;const r=(s=t.current)==null?void 0:s.getAttribute("aria-describedby");a&&r&&(document.getElementById(a)||console.warn(n))},[n,t,a]),null},Ze=q,Je=Z,Qe=J,et=Q,tt=te,at=se,st=ne;function ot({...t}){return e.jsx(Ze,{"data-slot":"dialog",...t})}function nt({...t}){return e.jsx(Je,{"data-slot":"dialog-portal",...t})}function rt({className:t,...a}){return e.jsx(Qe,{"data-slot":"dialog-overlay",className:b("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...a})}function it({className:t,children:a,...o}){return e.jsxs(nt,{"data-slot":"dialog-portal",children:[e.jsx(rt,{}),e.jsxs(et,{"data-slot":"dialog-content",className:b("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...o,children:[a,e.jsxs(st,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[e.jsx(Ve,{}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function lt({className:t,...a}){return e.jsx("div",{"data-slot":"dialog-header",className:b("flex flex-col gap-2 text-center sm:text-left",t),...a})}function ct({className:t,...a}){return e.jsx(tt,{"data-slot":"dialog-title",className:b("text-lg leading-none font-semibold",t),...a})}function dt({className:t,...a}){return e.jsx(at,{"data-slot":"dialog-description",className:b("text-muted-foreground text-sm",t),...a})}function It(){const{lecturerId:t}=ve(),{user:a}=je(),o=Ne(),[n,r]=i.useState(""),[s,c]=i.useState(""),[d,g]=i.useState("VISA"),[f,p]=i.useState(!1),[N,le]=i.useState(null),[w,ce]=i.useState(""),[L,de]=i.useState("");i.useEffect(()=>{a||o("/login")},[a,o]);const[u,ue]=i.useState(null),[$,me]=i.useState([]);if(i.useEffect(()=>{t&&(ye(t).then(ue),Ce(t).then(me))},[t]),!u)return e.jsx("div",{children:"Lecturer not found"});const ge=$.slice(0,7),x=$.find(l=>l.date===n),B=(x==null?void 0:x.timeSlots.filter(l=>l.available))||[],fe=l=>{l.target.files&&l.target.files[0]&&le(l.target.files[0])},pe=()=>{if(!n||!s){C.error("Please select a date and time");return}p(!0)},xe=async()=>{if(d==="VISA"){if(!w||w.length<16){C.error("Please enter a valid card number");return}const l={studentId:a.id,studentName:a.name,lecturerId:u.id,lecturerName:u.name,subject:u.subject,date:n,time:s,status:"CONFIRMED",paymentMethod:"VISA",paymentStatus:"APPROVED",price:u.price};x&&await W(x.id,L,l),C.success("Booking confirmed! Payment successful."),p(!1),o("/student/bookings")}else{if(!N){C.error("Please upload a payment receipt");return}let l="";try{l=await De(a.id,N)}catch{}const h={studentId:a.id,studentName:a.name,lecturerId:u.id,lecturerName:u.name,subject:u.subject,date:n,time:s,status:"PENDING",paymentMethod:"RECEIPT",paymentStatus:"PENDING",receiptUrl:l||void 0,price:u.price};x&&await W(x.id,L,h),C.success("Booking submitted! Waiting for admin approval."),p(!1),o("/student/bookings")}};return e.jsxs("div",{className:"min-h-screen",style:{backgroundColor:"#f8f9fa"},children:[e.jsx("div",{className:"sticky top-0 z-10 shadow-sm",style:{backgroundColor:"#0066FF"},children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(y,{variant:"ghost",size:"sm",onClick:()=>o(`/student/lecturer/${t}`),className:"text-white hover:bg-white/20",children:e.jsx(Ae,{className:"w-5 h-5"})}),e.jsx("h1",{className:"text-white font-semibold",children:"Book a Class"})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[e.jsx(F,{className:"mb-6",children:e.jsx(S,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("img",{src:u.avatar,alt:u.name,className:"w-16 h-16 rounded-full object-cover"}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-lg",children:u.name}),e.jsx("p",{className:"text-sm",style:{color:"#0066FF"},children:u.subject}),e.jsxs("p",{className:"text-sm font-semibold mt-1",children:["$",u.price," / hour"]})]})]})})}),e.jsxs(F,{className:"mb-6",children:[e.jsx(G,{children:e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(Oe,{className:"w-5 h-5",style:{color:"#0066FF"}}),"Select Date"]})}),e.jsx(S,{children:e.jsx("div",{className:"grid grid-cols-2 gap-3",children:ge.map(l=>{const h=new Date(l.date),V=n===l.date;return e.jsxs(y,{variant:V?"default":"outline",className:"h-auto py-3 flex flex-col",style:V?{backgroundColor:"#0066FF",color:"white"}:{},onClick:()=>{r(l.date),c("")},children:[e.jsx("span",{className:"text-sm font-semibold",children:h.toLocaleDateString("en-US",{weekday:"short"})}),e.jsx("span",{className:"text-xs",children:h.toLocaleDateString("en-US",{month:"short",day:"numeric"})})]},l.id)})})})]}),n&&e.jsxs(F,{className:"mb-6",children:[e.jsx(G,{children:e.jsx(z,{style:{color:"#0066FF"},children:"Select Time"})}),e.jsxs(S,{children:[e.jsx("div",{className:"grid grid-cols-2 gap-3",children:B.map(l=>{const h=s===l.time;return e.jsx(y,{variant:h?"default":"outline",style:h?{backgroundColor:"#FFD700",color:"#000"}:{},onClick:()=>{c(l.time),de(l.id)},children:l.time},l.id)})}),B.length===0&&e.jsx("p",{className:"text-center text-gray-500 py-4",children:"No available slots for this date"})]})]}),n&&s&&e.jsx(y,{className:"w-full h-12 text-white text-lg",style:{backgroundColor:"#0066FF"},onClick:pe,children:"Proceed to Payment"})]}),e.jsx(ot,{open:f,onOpenChange:p,children:e.jsxs(it,{className:"max-w-md",children:[e.jsxs(lt,{children:[e.jsx(ct,{style:{color:"#0066FF"},children:"Complete Payment"}),e.jsxs(dt,{children:["Total Amount: $",u.price]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(v,{className:"mb-3 block",children:"Payment Method"}),e.jsxs(be,{value:d,onValueChange:l=>g(l),children:[e.jsxs("div",{className:"flex items-center space-x-2 p-3 border rounded-lg",children:[e.jsx(U,{value:"VISA",id:"visa"}),e.jsxs(v,{htmlFor:"visa",className:"flex items-center gap-2 cursor-pointer flex-1",children:[e.jsx(Me,{className:"w-5 h-5",style:{color:"#0066FF"}}),"Pay with Visa Card"]})]}),e.jsxs("div",{className:"flex items-center space-x-2 p-3 border rounded-lg",children:[e.jsx(U,{value:"RECEIPT",id:"receipt"}),e.jsxs(v,{htmlFor:"receipt",className:"flex items-center gap-2 cursor-pointer flex-1",children:[e.jsx($e,{className:"w-5 h-5",style:{color:"#FFD700"}}),"Upload Payment Receipt"]})]})]})]}),d==="VISA"?e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"cardNumber",children:"Card Number"}),e.jsx(R,{id:"cardNumber",placeholder:"1234 5678 9012 3456",value:w,onChange:l=>ce(l.target.value.replace(/\D/g,"")),maxLength:16}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(v,{htmlFor:"expiry",children:"Expiry Date"}),e.jsx(R,{id:"expiry",placeholder:"MM/YY"})]}),e.jsxs("div",{children:[e.jsx(v,{htmlFor:"cvv",children:"CVV"}),e.jsx(R,{id:"cvv",placeholder:"123",maxLength:3})]})]})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"receipt",children:"Upload Receipt (Image or PDF)"}),e.jsx(R,{id:"receipt",type:"file",accept:"image/*,.pdf",onChange:fe}),N&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-600",children:[e.jsx(Te,{className:"w-4 h-4"}),N.name]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Your booking will be pending until admin approves the payment"})]}),e.jsx(y,{className:"w-full text-white",style:{backgroundColor:"#0066FF"},onClick:xe,children:d==="VISA"?"Pay Now":"Submit Booking"})]})]})})]})}export{It as default};
