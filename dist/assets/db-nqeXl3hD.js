import{g as d,f as c,s as B,h as l,i as S,q as u,o as f,w as p,k as D,l as e,m as A,n as E,p as I,v as L,x as q,y as k,F as i}from"./index-BToGKl4C.js";import{m as w,a as b}from"./mockData-meiYRdoj.js";const x=async()=>{if(!i)return w;const t=await d(c(e,"lecturers"));if(t.empty){for(const s of w)await B(l(c(e,"lecturers"),s.id),s);return(await d(c(e,"lecturers"))).docs.map(s=>({id:s.id,...s.data()}))}return t.docs.map(a=>({id:a.id,...a.data()}))},N=async t=>{if(!i)return w.find(n=>n.id===t)||null;const a=await S(l(e,"lecturers",t));return a.exists()?{id:a.id,...a.data()}:null},U=async t=>{if(!i)return b.filter(o=>o.lecturerId===t);const a=c(e,"availability"),s=u(a,p("lecturerId","==",t),f("date","asc")),n=await d(s);if(n.empty){const o=b.filter(r=>r.lecturerId===t);for(const r of o)await D(a,r);return(await d(u(a,p("lecturerId","==",t),f("date","asc")))).docs.map(r=>({id:r.id,...r.data()}))}return n.docs.map(o=>({id:o.id,...o.data()}))},$=async(t,a,s)=>{if(!i)return;const n=l(e,"availability",t);await A(e,async o=>{const y=await o.get(n);if(!y.exists())throw new Error("Availability not found");const r=y.data(),m=(r.timeSlots||[]).findIndex(g=>g.id===a&&g.available);if(m===-1)throw new Error("Slot unavailable");r.timeSlots[m].available=!1,o.update(n,{timeSlots:r.timeSlots});const v=l(c(e,"bookings"));o.set(v,{...s,createdAt:new Date().toISOString()})})},C=async(t,a)=>{if(!i)return"";const s=E(I,`receipts/${t}/${Date.now()}-${a.name}`);return await L(s,a),await q(s)},F=async t=>{if(!i)return[];const a=u(c(e,"bookings"),p("studentId","==",t),f("date","asc"));return(await d(a)).docs.map(n=>({id:n.id,...n.data()}))},P=async()=>{if(!i)return[];const t=u(c(e,"bookings"),p("paymentStatus","==","PENDING"));return(await d(t)).docs.map(s=>({id:s.id,...s.data()}))},G=async(t,a)=>{i&&await k(l(e,"bookings",t),a)},O=async t=>{if(!i)return[];const a=u(c(e,"bookings"),p("lecturerId","==",t),f("date","asc"));return(await d(a)).docs.map(n=>({id:n.id,...n.data()}))},T=async()=>i?(await d(c(e,"users"))).docs.map(a=>({id:a.id,...a.data()})):[],_=async(t,a)=>{i&&await k(l(e,"users",t),{role:a})},j=async()=>i?(await d(c(e,"bookings"))).docs.map(a=>({id:a.id,...a.data()})):[];export{U as a,F as b,O as c,P as d,T as e,j as f,N as g,G as h,_ as i,x as l,$ as r,C as u};
